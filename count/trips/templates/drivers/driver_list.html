{% extends "base.html" %}
{% load static %}
{% block title %}Choferes{% endblock %}

{% block content %}
<div class="container mt-4">

  <!-- Encabezado -->
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-3 mb-4">
    <h2 class="mb-2 mb-md-0">Choferes registrados</h2>
    <div class="d-flex flex-wrap gap-2">
      <a href="{% url 'trips:driver_create' %}" class="btn btn-success">
        <i class="bi bi-person-plus-fill me-1"></i> Nuevo chofer
      </a>
      <a href="{% url 'trips:vehicle_create' %}" class="btn btn-outline-success">
        <i class="bi bi-truck me-1"></i> Nuevo vehículo
      </a>
    </div>
  </div>

  <!-- Lista de choferes -->
  {% if drivers %}
    <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4">
      {% for driver in drivers %}
        <div class="col">
          <div class="card h-100 shadow-sm border-0">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ driver.name }} {{ driver.surname }}</h5>
              <ul class="list-unstyled mb-2 small">
                <li><strong>DNI:</strong> {{ driver.dni }}</li>
                <li><strong>Teléfono:</strong> {{ driver.phone }}</li>
                <li><strong>Email:</strong> {{ driver.gmail }}</li>
                <li><strong>Licencia:</strong> {{ driver.license_number }} (vence {{ driver.license_expiry|date:"d/m/Y" }})</li>
              </ul>

              {% if driver.vehicle_set.all %}
                <p class="mb-1"><strong>Vehículos asignados:</strong></p>
                <ul class="mb-2">
                  {% for v in driver.vehicle_set.all %}
                    <li>{{ v.plate }} – {{ v.description }}</li>
                  {% endfor %}
                </ul>
              {% else %}
                <p class="text-muted mb-2">Sin vehículos asignados</p>
              {% endif %}

              <div class="mt-auto">
                <a href="{% url 'trips:assign_vehicles' driver.id %}" class="btn btn-outline-primary btn-sm w-100">
                  <i class="bi bi-truck me-1"></i> Asignar vehículo
                </a>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info mt-3">No hay choferes registrados.</div>
  {% endif %}

</div>
{% endblock %}
